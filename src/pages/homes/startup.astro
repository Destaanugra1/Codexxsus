---
import Layout from '~/layouts/PageLayout.astro';

import Hero from '~/components/widgets/Hero.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

import Features2 from '~/components/widgets/Features2.astro';
import Features from '~/components/widgets/Features.astro';
import Stats from '~/components/widgets/Stats.astro';
import Features3 from '~/components/widgets/Features3.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import Brands from '~/components/widgets/Brands.astro';

import { YouTube } from 'astro-embed';

const metadata = {
  title: 'Codexsus - Website untuk Startup & Bisnis Modern',
};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  <Hero
    tagline='Website untuk Startup'
    actions={[
      {
        variant: 'primary',
        target: '_blank',
        text: 'Hubungi Kami',
        href: 'https://wa.me/62895610090128?text=Halo%20Codexsus!%20Saya%20ingin%20website%20untuk%20startup.%20Bisakah%20kita%20diskusi%3F',
        icon: 'tabler:brand-whatsapp',
      },
      { text: 'Lihat Portfolio', href: '#features' },
    ]}>
    <Fragment slot='title'>
      Bangun <span class='hidden sm:inline'>online presence yang kuat untuk</span>
      <span class='text-accent dark:text-white'>Startup</span> Anda bersama Codexsus
    </Fragment>

    <Fragment slot='subtitle'>
      Wujudkan visi startup Anda dengan <span class='font-semibold'>website profesional</span> yang memperkuat kredibilitas,
      menarik investor, dan menjangkau target market yang lebih luas.
    </Fragment>

    <!-- <Fragment slot='image'>
      <YouTube id='gxBkghlglTg' title='Astro just Launched.... Could it be the ultimate web framework?' />
      <style is:inline>
        lite-youtube {
          margin: 0 auto;
          max-width: 100%;
        }
      </style>
    </Fragment> -->
  </Hero>

  <!-- Features2 Widget ************** -->

  <Features2
    title='About us'
    subtitle='We believe in the magic of turning dreams into stunning realities. Founded by passionate developers with a shared vision, we set out to simplify the website creation process. Our templates bring together the innovation of Astro 5.0 and the versatility of Tailwind CSS, enabling you to express your unique brand identity like never before.'>
    <Fragment slot='bg'>
      <div class='absolute inset-0 bg-blue-50 dark:bg-transparent'></div>
    </Fragment>
  </Features2>

  <!-- Stats Widget ****************** -->

  <div class='stats-section bg-[#050721]'>
    <Stats
      title='Temukan Dampak Luar Biasa dari Codexsus'
      subtitle="The numbers below reflect the trust our users have placed in us and the remarkable outcomes we've helped them achieve."
      stats={[
        { title: 'DOWNLOADS', amount: '0' },
        { title: 'WEBSITES LAUNCHED', amount: '0' },
        { title: 'USER RATINGS', amount: '0' },
      ]}
      id='animated-stats'
      classes={{
        container: 'py-12',
        title: 'text-white',
        subtitle: 'text-gray-300',
        statsIcon: 'text-white',
        statsContainer: 'mt-8',
      }}
    />
  </div>

  <style>
    .stats-section {
      background-color: #050721;
      color: white;
    }

    #animated-stats {
      --column-count: 4;
    }

    @media (max-width: 768px) {
      #animated-stats {
        --column-count: 2;
      }
    }

    #animated-stats .flex {
      display: flex;
      justify-content: space-between;
      border-color: rgba(255, 255, 255, 0.1);
      padding: 0;
      max-width: 1200px;
      margin: 0 auto;
    }

    #animated-stats .flex > div {
      width: calc(100% / var(--column-count));
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      padding: 0 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #animated-stats .flex > div:last-child {
      border-right: none;
    }

    #animated-stats .font-heading {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    #animated-stats .text-sm {
      font-size: 0.875rem;
      letter-spacing: 0.1em;
      color: rgba(255, 255, 255, 0.7);
    }
  </style>

  <!-- Brands Widget ****************** -->

  <Brands
    title='Partnerships & Collaborations'
    subtitle='Di Codexsus, kami percaya pada kekuatan kolaborasi untuk mendorong inovasi dan menciptakan pengalaman yang luar biasa.'
    icons={[]}
    images={[
      {
        src: 'https://cdn.pixabay.com/photo/2015/05/26/09/37/paypal-784404_1280.png',
        alt: 'Paypal',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2021/12/06/13/48/visa-6850402_1280.png',
        alt: 'Visa',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2013/10/01/10/29/ebay-189064_1280.png',
        alt: 'Ebay',
      },

      {
        src: 'https://cdn.pixabay.com/photo/2015/04/13/17/45/icon-720944_1280.png',
        alt: 'Youtube',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2013/02/12/09/07/microsoft-80658_1280.png',
        alt: 'Microsoft',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2015/04/23/17/41/node-js-736399_1280.png',
        alt: 'Node JS',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2015/10/31/12/54/google-1015751_1280.png',
        alt: 'Google',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2021/12/06/13/45/meta-6850393_1280.png',
        alt: 'Meta',
      },
      {
        src: 'https://cdn.pixabay.com/photo/2013/01/29/22/53/yahoo-76684_1280.png',
        alt: 'Yahoo',
      },
    ]}
  />

  <!-- Features2 Widget ************** -->

  <Features2
    title='What services do we provide?'
    subtitle='We offer a wide range of website templates that suit various industries and purposes such as business, portfolio, e-commerce, blog, etc.'
    items={[
      {
        title: 'Installation Instructions',
        description:
          'Offer clear instructions on how to download the purchased templates and install them on various website platforms or content management systems.',
        icon: 'flat-color-icons:document',
      },
      {
        title: 'Demo and Previews',
        description:
          'Provide interactive demos and previews that allow customers to see how their chosen template will look and function before making a purchase.',
        icon: 'flat-color-icons:template',
      },
      {
        title: 'Technical Support',
        description:
          'Providing customer support for any technical issues related to the templates or their implementation.',
        icon: 'flat-color-icons:voice-presentation',
      },
    ]}>
    <Fragment slot='bg'>
      <div class='absolute inset-0 bg-blue-50 dark:bg-transparent'></div>
    </Fragment>
  </Features2>

  <!-- Features Widget *************** -->

  <Features
    id='features'
    title='Main features of our templates'
    subtitle='Possess several key characteristics to effectively cater to the needs of startups and entrepreneurs.'
    columns={3}
    items={[
      {
        title: 'Modern and Professional Design',
        description:
          'Have a contemporary design that reflects current design trends and gives a professional impression.',
        icon: 'tabler:artboard',
      },
      {
        title: 'Responsive and Mobile-Friendly',
        description: 'Adapt seamlessly to different screen sizes and devices to ensure a consistent experience.',
        icon: 'tabler:picture-in-picture',
      },
      {
        title: 'Customizability',
        description:
          'Easily customizable, allowing users to adapt the design, colors, typography, and content to match their brand identity.',
        icon: 'tabler:adjustments-horizontal',
      },
      {
        title: 'Fast Loading Times',
        description: 'Optimized for speed to ensure a smooth user experience and favorable search engine rankings.',
        icon: 'tabler:rocket',
      },
      {
        title: 'Search Engine Optimization (SEO)',
        description:
          'Incorporate SEO best practices in template structure and code to improve visibility in search engine results.',
        icon: 'tabler:arrows-right-left',
      },
      {
        title: 'Compatibility',
        description: 'The templates work seamlessly across various content management systems and website builders.',
        icon: 'tabler:plug-connected',
      },
    ]}
  />

  <!-- FAQs Widget ******************* -->

  <FAQs
    title='Frequently Asked Questions'
    items={[
      {
        title: 'What are landing page templates?',
        description:
          'Landing page templates are pre-designed web page layouts that are specifically created to serve as a foundation for building effective landing pages. These templates are designed to capture the attention of visitors and guide them towards a specific action or goal, such as signing up for a newsletter, making a purchase, or downloading a resource.',
      },
      {
        title: 'Why should I use a template?',
        description:
          'Some of the advantages are that they provide a ready-to-use structure,  saving you significant time. Are designed with user-friendliness in mind and provide a cost-effective alternative, saving you money while still delivering a quality result.',
      },
      {
        title: 'Can I preview templates before buying?',
        description:
          'Yes, the templates allow you to preview them before making a purchase. There is a "Demo" button associated with each template.',
      },
      {
        title: 'Do I need technical skills to use a template?',
        description:
          'Advanced technical skills are not required to use a template, but having a basic understanding of web navigation and familiarity with using online tools can still be beneficial. If you have more specific customization needs, you might need to consult guides or reach out to customer support for assistance.',
      },
      {
        title: 'Can I use the template on multiple websites?',
        description:
          'No, the template comes with a single-use license, meaning you can use the template on one website or project only. Using the template on additional websites would require purchasing additional licenses.',
      },
      {
        title: 'What if I need help with customization?',
        description:
          "The templates provides a comprehensive step-by-step guide that walk you through the customization process. If you still have doubts, you can reach out to our customer support team. They can answer your questions, provide guidance on customization, and address any issues you're facing.",
      },
    ]}>
    <Fragment slot='bg'>
      <div class='absolute inset-0 bg-blue-50 dark:bg-transparent'></div>
    </Fragment>
  </FAQs>

  <!-- Features3 Widget ************** -->

  <Features3
    title='Let us know how we can help'
    subtitle='Weâ€™re here to help and answer any question you might have.'
    columns={4}
    items={[
      {
        title: 'Phone',
        icon: 'tabler:phone',
        callToAction: {
          target: '_blank',
          text: 'Call us',
          href: '/',
          variant: 'link',
        },
      },
      {
        title: 'Email',
        icon: 'tabler:mail',
        callToAction: {
          target: '_blank',
          text: 'Write to us',
          href: '/',
          variant: 'link',
        },
      },
      {
        title: 'Chat with sales',
        icon: 'tabler:message-circle',
        callToAction: {
          target: '_blank',
          text: 'Start chatting',
          href: '/',
          variant: 'link',
        },
      },
      {
        title: 'Chat with support',
        icon: 'tabler:message-circle',
        callToAction: {
          target: '_blank',
          text: 'Start chatting',
          href: '/',
          variant: 'link',
        },
      },
    ]}
  />

  <!-- CallToAction Widget *********** -->

  <CallToAction
    actions={[
      {
        variant: 'primary',
        target: '_blank',
        text: 'Get templates',
        href: 'https://wa.me/6281234567890',
        icon: 'tabler:download',
      },
    ]}>
    <Fragment slot='title'>Be a part of our vision</Fragment>

    <Fragment slot='subtitle'>
      Discover a dynamic work environment, unparalleled growth opportunities, and the chance to make a meaningful
      impact.
    </Fragment>
  </CallToAction>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Give the DOM time to render fully with all styles
    setTimeout(() => {
      initStatsAnimation();
    }, 100);

    function initStatsAnimation() {
      // Function to animate counting with smooth easing
      function animateValue(obj, start, end, duration, isThousand, hasDecimal) {
        let startTimestamp = null;

        // Easing function for smoother animation
        // This creates a more natural-looking count effect that slows down at the end
        const easeOutQuart = (t) => 1 - Math.pow(1 - t, 4);

        const step = (timestamp) => {
          if (!startTimestamp) startTimestamp = timestamp;
          const elapsed = timestamp - startTimestamp;
          const progress = Math.min(elapsed / duration, 1);

          // Apply easing for smoother animation
          const easedProgress = easeOutQuart(progress);

          // Calculate the current value based on progress
          let value;
          if (hasDecimal) {
            value = easedProgress * (end - start) + start;
          } else {
            value = Math.floor(easedProgress * (end - start) + start);
          }

          // Format the display value
          let displayValue;
          if (isThousand) {
            if (hasDecimal) {
              displayValue = (value / 1000).toFixed(1) + 'K';
            } else {
              displayValue = Math.floor(value / 1000) + 'K';
            }
          } else if (hasDecimal) {
            // For decimal values like 4.8
            displayValue = value.toFixed(1);
          } else {
            displayValue = value.toString();
          }

          obj.innerHTML = displayValue;

          if (progress < 1) {
            window.requestAnimationFrame(step);
          } else {
            // Ensure the final value is exactly the target value
            if (isThousand) {
              if (hasDecimal) {
                obj.innerHTML = (end / 1000).toFixed(1) + 'K';
              } else {
                obj.innerHTML = Math.floor(end / 1000) + 'K';
              }
            } else if (hasDecimal) {
              obj.innerHTML = end.toFixed(1);
            } else {
              obj.innerHTML = end.toString();
            }
          }
        };
        window.requestAnimationFrame(step);
      }

      // Directly target the stats container
      const statsSection = document.getElementById('animated-stats');
      if (!statsSection) {
        console.error('Stats section not found!');
        return;
      }

      // Animation should run every time the element comes into view
      // We're removing the localStorage check to ensure animation plays each time

      // Get the specific stats values - updated to match the UI in the image
      const targetValues = [
        { value: 182000, isThousand: true, hasDecimal: false }, // 182K Downloads
        { value: 87, isThousand: false, hasDecimal: false }, // 87 Websites Launched
        { value: 4.8, isThousand: false, hasDecimal: true }, // 4.8 User Ratings
        { value: 116000, isThousand: true, hasDecimal: false }, // 116K Satisfied Clients
      ];

      // Find all elements with numbers in the stats section
      // Updated selectors for our custom styled stats
      const selectors = [
        '.font-heading', // Primary selector for the stats
        '#animated-stats .flex > div > div:first-of-type', // Target the first div in each stat item (the number)
        '#animated-stats [class*="text-primary"]',
        '#animated-stats [class*="font-bold"]',
        '.text-white.text-4xl',
        '.text-white.text-5xl',
        '[class*="text-white"]',
        '[class*="statsValueContainer"]',
        '[class*="text-5xl"]',
      ];

      // Try each selector until we find elements
      let numberElements = [];
      for (const selector of selectors) {
        const elements = statsSection.querySelectorAll(selector);
        if (elements.length > 0) {
          console.log(`Found ${elements.length} elements with selector: ${selector}`);
          numberElements = elements;
          break;
        }
      }

      if (numberElements.length === 0) {
        // Direct method - find all divs inside the stats container
        console.log('Using direct method to find stat elements');

        // Get the flex container that holds all the stat items
        const flexContainer = statsSection.querySelector('.flex');
        if (flexContainer) {
          // Get all direct child divs (stat items)
          const statItems = Array.from(flexContainer.children);

          // From each stat item, get the first div (which should be the number)
          numberElements = statItems
            .map((item) => {
              // Find the element that contains the number
              const numberElement = item.querySelector('div:first-of-type, .font-heading, [class*="text-primary"]');
              return numberElement;
            })
            .filter((el) => el); // Filter out any undefined elements

          console.log(`Found ${numberElements.length} stat elements via direct structure navigation`);
        }

        // If we still don't have elements, try a text-based approach
        if (numberElements.length === 0) {
          console.error('Could not find stat elements with standard selectors or direct navigation');

          // Get all direct child divs that might contain the numbers
          const allDivs = statsSection.querySelectorAll('div');

          // Filter to only those likely to be stat numbers (containing only numbers and possibly K, decimal point)
          const likelyStatElements = Array.from(allDivs).filter((el) => {
            const text = el.textContent?.trim();
            return text && /^[0-9K.]+$/.test(text);
          });

          if (likelyStatElements.length > 0) {
            console.log(`Found ${likelyStatElements.length} likely stat elements by content`);
            numberElements = likelyStatElements;
          }
        }
      }

      if (numberElements.length > 0) {
        // Set up intersection observer for animation
        setupAnimation(numberElements, targetValues);
      } else {
        console.error('Failed to find any stat elements to animate');
      }
      function setupAnimation(elements, values) {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                console.log('Stats section is visible, starting animation');

                // Animate each stat element
                elements.forEach((el, index) => {
                  if (index < values.length) {
                    const { value, isThousand, hasDecimal } = values[index];

                    // Start the animation from 0 to the target value
                    animateValue(el, 0, value, 2000, isThousand, hasDecimal);
                  }
                });

                // Disconnect the observer once animation starts
                // This ensures the animation only runs once per scroll into view
                observer.disconnect();
              }
            });
          },
          {
            root: null,
            rootMargin: '0px',
            threshold: 0.1,
          }
        );

        // Make sure statsSection exists before observing
        if (statsSection) {
          // Start observing the stats section
          observer.observe(statsSection);
        }
      }
    } // Close the initStatsAnimation function
  });
</script>
